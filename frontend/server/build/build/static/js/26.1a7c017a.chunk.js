(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{2145:function(e,t){e.exports=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}},2301:function(e,t,r){"use strict";var n=r(23),o=r(38),i=r(61),a=r(56),s=r(1),c=r.n(s),u=r(0),l=r.n(u),h=r(6),d=r.n(h),p=r(239),f={active:l.a.bool,"aria-label":l.a.string,block:l.a.bool,color:l.a.string,disabled:l.a.bool,outline:l.a.bool,tag:p.p,innerRef:l.a.oneOfType([l.a.object,l.a.func,l.a.string]),onClick:l.a.func,size:l.a.string,children:l.a.node,className:l.a.string,cssModule:l.a.object,close:l.a.bool},g=function(e){function t(t){var r;return(r=e.call(this,t)||this).onClick=r.onClick.bind(Object(i.a)(r)),r}Object(a.a)(t,e);var r=t.prototype;return r.onClick=function(e){this.props.disabled?e.preventDefault():this.props.onClick&&this.props.onClick(e)},r.render=function(){var e=this.props,t=e.active,r=e["aria-label"],i=e.block,a=e.className,s=e.close,u=e.cssModule,l=e.color,h=e.outline,f=e.size,g=e.tag,m=e.innerRef,y=Object(o.a)(e,["active","aria-label","block","className","close","cssModule","color","outline","size","tag","innerRef"]);s&&"undefined"===typeof y.children&&(y.children=c.a.createElement("span",{"aria-hidden":!0},"\xd7"));var v="btn"+(h?"-outline":"")+"-"+l,b=Object(p.l)(d()(a,{close:s},s||"btn",s||v,!!f&&"btn-"+f,!!i&&"btn-block",{active:t,disabled:this.props.disabled}),u);y.href&&"button"===g&&(g="a");var I=s?"Close":null;return c.a.createElement(g,Object(n.a)({type:"button"===g&&y.onClick?"button":void 0},y,{className:b,ref:m,onClick:this.onClick,"aria-label":r||I}))},t}(c.a.Component);g.propTypes=f,g.defaultProps={color:"secondary",tag:"button"},t.a=g},2305:function(e,t,r){"use strict";var n=r(23),o=r(38),i=r(61),a=r(56),s=r(1),c=r.n(s),u=r(0),l=r.n(u),h=r(6),d=r.n(h),p=r(239),f={children:l.a.node,type:l.a.string,size:l.a.string,bsSize:l.a.string,valid:l.a.bool,invalid:l.a.bool,tag:p.p,innerRef:l.a.oneOfType([l.a.object,l.a.func,l.a.string]),plaintext:l.a.bool,addon:l.a.bool,className:l.a.string,cssModule:l.a.object},g=function(e){function t(t){var r;return(r=e.call(this,t)||this).getRef=r.getRef.bind(Object(i.a)(r)),r.focus=r.focus.bind(Object(i.a)(r)),r}Object(a.a)(t,e);var r=t.prototype;return r.getRef=function(e){this.props.innerRef&&this.props.innerRef(e),this.ref=e},r.focus=function(){this.ref&&this.ref.focus()},r.render=function(){var e=this.props,t=e.className,r=e.cssModule,i=e.type,a=e.bsSize,s=e.valid,u=e.invalid,l=e.tag,h=e.addon,f=e.plaintext,g=e.innerRef,m=Object(o.a)(e,["className","cssModule","type","bsSize","valid","invalid","tag","addon","plaintext","innerRef"]),y=["radio","checkbox"].indexOf(i)>-1,v=new RegExp("\\D","g"),b=l||("select"===i||"textarea"===i?i:"input"),I="form-control";f?(I+="-plaintext",b=l||"input"):"file"===i?I+="-file":y&&(I=h?null:"form-check-input"),m.size&&v.test(m.size)&&(Object(p.r)('Please use the prop "bsSize" instead of the "size" to bootstrap\'s input sizing.'),a=m.size,delete m.size);var w=Object(p.l)(d()(t,u&&"is-invalid",s&&"is-valid",!!a&&"form-control-"+a,I),r);return("input"===b||l&&"function"===typeof l)&&(m.type=i),m.children&&!f&&"select"!==i&&"string"===typeof b&&"select"!==b&&(Object(p.r)('Input with a type of "'+i+'" cannot have children. Please use "value"/"defaultValue" instead.'),delete m.children),c.a.createElement(b,Object(n.a)({},m,{ref:g,className:w}))},t}(c.a.Component);g.propTypes=f,g.defaultProps={type:"text"},t.a=g},2334:function(e,t,r){"use strict";var n=r(23),o=r(38),i=r(1),a=r.n(i),s=r(0),c=r.n(s),u=r(6),l=r.n(u),h=r(239),d={tag:h.p,noGutters:c.a.bool,className:c.a.string,cssModule:c.a.object,form:c.a.bool},p=function(e){var t=e.className,r=e.cssModule,i=e.noGutters,s=e.tag,c=e.form,u=Object(o.a)(e,["className","cssModule","noGutters","tag","form"]),d=Object(h.l)(l()(t,i?"no-gutters":null,c?"form-row":"row"),r);return a.a.createElement(s,Object(n.a)({},u,{className:d}))};p.propTypes=d,p.defaultProps={tag:"div"},t.a=p},2335:function(e,t,r){"use strict";var n=r(23),o=r(38),i=r(2145),a=r.n(i),s=r(1),c=r.n(s),u=r(0),l=r.n(u),h=r(6),d=r.n(h),p=r(239),f=l.a.oneOfType([l.a.number,l.a.string]),g=l.a.oneOfType([l.a.bool,l.a.number,l.a.string,l.a.shape({size:l.a.oneOfType([l.a.bool,l.a.number,l.a.string]),order:f,offset:f})]),m={tag:p.p,xs:g,sm:g,md:g,lg:g,xl:g,className:l.a.string,cssModule:l.a.object,widths:l.a.array},y={tag:"div",widths:["xs","sm","md","lg","xl"]},v=function(e,t,r){return!0===r||""===r?e?"col":"col-"+t:"auto"===r?e?"col-auto":"col-"+t+"-auto":e?"col-"+r:"col-"+t+"-"+r},b=function(e){var t=e.className,r=e.cssModule,i=e.widths,s=e.tag,u=Object(o.a)(e,["className","cssModule","widths","tag"]),l=[];i.forEach(function(t,n){var o=e[t];if(delete u[t],o||""===o){var i=!n;if(a()(o)){var s,c=i?"-":"-"+t+"-",h=v(i,t,o.size);l.push(Object(p.l)(d()(((s={})[h]=o.size||""===o.size,s["order"+c+o.order]=o.order||0===o.order,s["offset"+c+o.offset]=o.offset||0===o.offset,s)),r))}else{var f=v(i,t,o);l.push(f)}}}),l.length||l.push("col");var h=Object(p.l)(d()(t,l),r);return c.a.createElement(s,Object(n.a)({},u,{className:h}))};b.propTypes=m,b.defaultProps=y,t.a=b},2393:function(e,t,r){"undefined"!=typeof self&&self,e.exports=function(e){return n={},t.m=r=[function(t){t.exports=e},function(e,t,r){e.exports=r(2)()},function(e,t,r){"use strict";function n(){}function o(){}var i=r(3);o.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,o,a){if(a!==i){var s=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}var r={array:e.isRequired=e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:n};return r.PropTypes=r}},function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){null!=t&&t<=e.length||(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){null!=t&&t<=e.length||(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){null!=t&&t<=e.length||(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){null!=t&&t<=e.length||(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t,r,n,o){var i=e.getElementsByTagName(t)[0],a=i,s=i;(s=e.createElement(t)).id=r,s.src=n,a&&a.parentNode?a.parentNode.insertBefore(s,a):e.head.appendChild(s),s.onload=o}function d(e,t){var r=e.getElementById(t);r&&r.parentNode.removeChild(r)}function p(e){return y.a.createElement("span",{style:{paddingRight:10,fontWeight:500,paddingLeft:e.icon?0:10,paddingTop:10,paddingBottom:10}},e.children)}function f(e){return y.a.createElement("div",{style:{marginRight:10,background:e.active?"#eee":"#fff",padding:10,borderRadius:2}},y.a.createElement("svg",{width:"18",height:"18",xmlns:"http://www.w3.org/2000/svg"},y.a.createElement("g",{fill:"#000",fillRule:"evenodd"},y.a.createElement("path",{d:"M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z",fill:"#EA4335"}),y.a.createElement("path",{d:"M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z",fill:"#4285F4"}),y.a.createElement("path",{d:"M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z",fill:"#FBBC05"}),y.a.createElement("path",{d:"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z",fill:"#34A853"}),y.a.createElement("path",{fill:"none",d:"M0 0h18v18H0z"}))))}function g(e){var t=i(Object(m.useState)(!1),2),r=t[0],n=t[1],o=i(Object(m.useState)(!1),2),a=o[0],s=o[1],c=e.tag,u=e.type,l=e.className,h=e.disabledStyle,d=e.buttonText,g=e.children,b=e.render,I=e.theme,w=e.icon,T=e.disabled,E=v({onSuccess:e.onSuccess,clientId:e.clientId,cookiePolicy:e.cookiePolicy,loginHint:e.loginHint,hostedDomain:e.hostedDomain,autoLoad:e.autoLoad,isSignedIn:e.isSignedIn,fetchBasicProfile:e.fetchBasicProfile,redirectUri:e.redirectUri,discoveryDocs:e.discoveryDocs,onFailure:e.onFailure,uxMode:e.uxMode,scope:e.scope,accessType:e.accessType,responseType:e.responseType,jsSrc:e.jsSrc,onRequest:e.onRequest,prompt:e.prompt}),S=E.signIn,C=T||!E.loaded;if(b)return b({onClick:S,disabled:C});var k={backgroundColor:"dark"===I?"rgb(66, 133, 244)":"#fff",display:"inline-flex",alignItems:"center",color:"dark"===I?"#fff":"rgba(0, 0, 0, .54)",boxShadow:"0 2px 2px 0 rgba(0, 0, 0, .24), 0 0 1px 0 rgba(0, 0, 0, .24)",padding:0,borderRadius:2,border:"1px solid transparent",fontSize:14,fontWeight:"500",fontFamily:"Roboto, sans-serif"},A={cursor:"pointer",backgroundColor:"dark"===I?"#3367D6":"#eee",color:"dark"===I?"#fff":"rgba(0, 0, 0, .54)",opacity:1},O=C?Object.assign({},k,h):a?Object.assign({},k,A):r?Object.assign({},k,{cursor:"pointer",opacity:.9}):k;return y.a.createElement(c,{onMouseEnter:function(){return n(!0)},onMouseLeave:function(){n(!1),s(!1)},onMouseDown:function(){return s(!0)},onMouseUp:function(){return s(!1)},onClick:S,style:O,type:u,disabled:C,className:l},[w&&y.a.createElement(f,{key:1,active:a}),y.a.createElement(p,{icon:w,key:2},g||d)])}r.r(t),r.d(t,"default",function(){return I}),r.d(t,"GoogleLogin",function(){return I}),r.d(t,"GoogleLogout",function(){return T}),r.d(t,"useGoogleLogin",function(){return v}),r.d(t,"useGoogleLogout",function(){return w});var m=r(0),y=r.n(m),v=(r(1),function(e){function t(e){var t=e.getBasicProfile(),r=e.getAuthResponse();e.googleId=t.getId(),e.tokenObj=r,e.tokenId=r.id_token,e.accessToken=r.access_token,e.profileObj={googleId:t.getId(),imageUrl:t.getImageUrl(),email:t.getEmail(),name:t.getName(),givenName:t.getGivenName(),familyName:t.getFamilyName()},o(e)}function r(e){if(e&&e.preventDefault(),A){var r=window.gapi.auth2.getAuthInstance(),n={prompt:C};S(),"code"===w?r.grantOfflineAccess(n).then(function(e){return o(e)},function(e){return y(e)}):r.signIn(n).then(function(e){return t(e)},function(e){return y(e)})}}var o=e.onSuccess,i=e.clientId,a=e.cookiePolicy,s=e.loginHint,c=e.hostedDomain,u=e.autoLoad,l=e.isSignedIn,p=e.fetchBasicProfile,f=e.redirectUri,g=e.discoveryDocs,y=e.onFailure,v=e.uxMode,b=e.scope,I=e.accessType,w=e.responseType,T=e.jsSrc,E=void 0===T?"https://apis.google.com/js/api.js":T,S=e.onRequest,C=e.prompt,k=n(Object(m.useState)(!1),2),A=k[0],O=k[1];return Object(m.useEffect)(function(){var e=!1;return h(document,"script","google-login",E,function(){var r={client_id:i,cookie_policy:a,login_hint:s,hosted_domain:c,fetch_basic_profile:p,discoveryDocs:g,ux_mode:v,redirect_uri:f,scope:b,access_type:I};"code"===w&&(r.access_type="offline"),window.gapi.load("auth2",function(){window.gapi.auth2.getAuthInstance()?e||O(!0):window.gapi.auth2.init(r).then(function(r){e||(O(!0),l&&r.isSignedIn.get()&&t(r.currentUser.get()))},function(e){return y(e)})})}),function(){e=!0,d(document,"google-login")}},[]),Object(m.useEffect)(function(){u&&r()},[A]),{signIn:r,loaded:A}});function b(e){var t=u(Object(m.useState)(!1),2),r=t[0],n=t[1],o=u(Object(m.useState)(!1),2),i=o[0],a=o[1],s=e.tag,c=e.type,l=e.className,h=e.disabledStyle,d=e.buttonText,g=e.children,v=e.render,b=e.theme,I=e.icon,T=e.disabled,E=w({jsSrc:e.jsSrc,onFailure:e.onFailure,clientId:e.clientId,cookiePolicy:e.cookiePolicy,loginHint:e.loginHint,hostedDomain:e.hostedDomain,fetchBasicProfile:e.fetchBasicProfile,discoveryDocs:e.discoveryDocs,uxMode:e.uxMode,redirectUri:e.redirectUri,scope:e.scope,accessType:e.accessType,onLogoutSuccess:e.onLogoutSuccess}),S=E.signOut,C=T||!E.loaded;if(v)return v({onClick:S,disabled:C});var k={backgroundColor:"dark"===b?"rgb(66, 133, 244)":"#fff",display:"inline-flex",alignItems:"center",color:"dark"===b?"#fff":"rgba(0, 0, 0, .54)",boxShadow:"0 2px 2px 0 rgba(0, 0, 0, .24), 0 0 1px 0 rgba(0, 0, 0, .24)",padding:0,borderRadius:2,border:"1px solid transparent",fontSize:14,fontWeight:"500",fontFamily:"Roboto, sans-serif"},A={cursor:"pointer",backgroundColor:"dark"===b?"#3367D6":"#eee",color:"dark"===b?"#fff":"rgba(0, 0, 0, .54)",opacity:1},O=C?Object.assign({},k,h):i?Object.assign({},k,A):r?Object.assign({},k,{cursor:"pointer",opacity:.9}):k;return y.a.createElement(s,{onMouseEnter:function(){return n(!0)},onMouseLeave:function(){n(!1),a(!1)},onMouseDown:function(){return a(!0)},onMouseUp:function(){return a(!1)},onClick:S,style:O,type:c,disabled:C,className:l},[I&&y.a.createElement(f,{key:1,active:i}),y.a.createElement(p,{icon:I,key:2},g||d)])}g.defaultProps={type:"button",tag:"button",buttonText:"Sign in with Google",scope:"profile email",accessType:"online",prompt:"",cookiePolicy:"single_host_origin",fetchBasicProfile:!0,isSignedIn:!1,uxMode:"popup",disabledStyle:{opacity:.6},icon:!0,theme:"light",onRequest:function(){}};var I=g,w=function(e){var t=e.jsSrc,r=void 0===t?"https://apis.google.com/js/api.js":t,n=e.onFailure,o=e.clientId,i=e.cookiePolicy,a=e.loginHint,c=e.hostedDomain,u=e.fetchBasicProfile,l=e.discoveryDocs,p=e.uxMode,f=e.redirectUri,g=e.scope,y=e.accessType,v=e.onLogoutSuccess,b=s(Object(m.useState)(!1),2),I=b[0],w=b[1];return Object(m.useEffect)(function(){return h(document,"script","google-login",r,function(){var e={client_id:o,cookie_policy:i,login_hint:a,hosted_domain:c,fetch_basic_profile:u,discoveryDocs:l,ux_mode:p,redirect_uri:f,scope:g,access_type:y};window.gapi.load("auth2",function(){window.gapi.auth2.getAuthInstance()?w(!0):window.gapi.auth2.init(e).then(function(){return w(!0)},function(e){return n(e)})})}),function(){d(document,"google-login")}},[]),{signOut:function(){if(window.gapi){var e=window.gapi.auth2.getAuthInstance();null!=e&&e.signOut().then(e.disconnect().then(v))}},loaded:I}};b.defaultProps={type:"button",tag:"button",buttonText:"Logout of Google",disabledStyle:{opacity:.6},icon:!0,theme:"light",jsSrc:"https://apis.google.com/js/api.js"};var T=b}],t.c=n,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(t){return e[t]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4);function t(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return r[e].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r,n}(r(1))},2394:function(e,t,r){"use strict";var n=r(23),o=r(38),i=r(1),a=r.n(i),s=r(0),c=r.n(s),u=r(6),l=r.n(u),h=r(239),d={tag:h.p,inverse:c.a.bool,color:c.a.string,body:c.a.bool,outline:c.a.bool,className:c.a.string,cssModule:c.a.object,innerRef:c.a.oneOfType([c.a.object,c.a.string,c.a.func])},p=function(e){var t=e.className,r=e.cssModule,i=e.color,s=e.body,c=e.inverse,u=e.outline,d=e.tag,p=e.innerRef,f=Object(o.a)(e,["className","cssModule","color","body","inverse","outline","tag","innerRef"]),g=Object(h.l)(l()(t,"card",!!c&&"text-white",!!s&&"card-body",!!i&&(u?"border":"bg")+"-"+i),r);return a.a.createElement(d,Object(n.a)({},f,{className:g,ref:p}))};p.propTypes=d,p.defaultProps={tag:"div"},t.a=p},2395:function(e,t,r){"use strict";var n=r(23),o=r(38),i=r(1),a=r.n(i),s=r(0),c=r.n(s),u=r(6),l=r.n(u),h=r(239),d={tag:h.p,className:c.a.string,cssModule:c.a.object,innerRef:c.a.oneOfType([c.a.object,c.a.string,c.a.func])},p=function(e){var t=e.className,r=e.cssModule,i=e.innerRef,s=e.tag,c=Object(o.a)(e,["className","cssModule","innerRef","tag"]),u=Object(h.l)(l()(t,"card-body"),r);return a.a.createElement(s,Object(n.a)({},c,{className:u,ref:i}))};p.propTypes=d,p.defaultProps={tag:"div"},t.a=p},2538:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MicrosoftLogin=void 0;var o=n(r(2539));t.MicrosoftLogin=o.default,t.default=o.default},2539:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(r(1)),h=u(r(2540)),d=r(2541);t.default=function(e){var t=e.graphScopes,r=e.clientId,o=e.tenantUrl,i=e.redirectUri,a=e.postLogoutRedirectUri,u=e.children,p=e.buttonTheme,f=e.className,g=e.withUserData,m=void 0!==g&&g,y=e.authCallback,v=e.forceRedirectStrategy,b=void 0!==v&&v,I=e.prompt,w=e.debug,T=e.useLocalStorageCache,E=d.getUserAgentApp({clientId:r,tenantUrl:o,redirectUri:i,postLogoutRedirectUri:a,useLocalStorageCache:T}),S=d.getScopes(t),C=d.getLogger(w);if(!E)return C("Initialization","clientID broken or not provided",!0),null;l.useEffect(function(){E.handleRedirectCallback(function(e,t){!e&&t?(C("Fetch Azure AD 'token' with redirect SUCCEEDED",t),C("Fetch Graph API 'access_token' in silent mode STARTED"),O(!0)):(C("Fetch Azure AD 'token' with redirect FAILED",e,!0),y(e))})},[]),l.useEffect(function(){(T?localStorage.getItem("msal.idtoken"):sessionStorage.getItem("msal.idtoken"))&&O(b||d.checkToIE())},[E]);var k=function(){C("Login STARTED"),b||d.checkToIE()?_():R()},A=function(e){C("Fetch Graph API 'access_token' SUCCEEDED",e),m?P(e):(C("Login SUCCEEDED"),y(null,e,E))},O=function(e){return s(void 0,void 0,void 0,function(){var t,r,n,o;return c(this,function(i){switch(i.label){case 0:i.trys.push([0,8,,9]),i.label=1;case 1:return i.trys.push([1,3,,7]),[4,E.acquireTokenSilent({scopes:S})];case 2:return t=i.sent(),A(t),[3,7];case 3:return r=i.sent(),C("Fetch Graph API 'access_token' in silent mode is FAILED",r,!0),e?(C("Fetch Graph API 'access_token' with redirect STARTED"),E.acquireTokenRedirect({scopes:S}),[3,6]):[3,4];case 4:return C("Fetch Graph API 'access_token' with popup STARTED"),[4,E.acquireTokenPopup({scopes:S})];case 5:n=i.sent(),A(n),i.label=6;case 6:return[3,7];case 7:return[3,9];case 8:return o=i.sent(),C("Login FAILED",o,!0),y(o),[3,9];case 9:return[2]}})})},R=function(){return s(void 0,void 0,void 0,function(){var e,t;return c(this,function(r){switch(r.label){case 0:C("Fetch Azure AD 'token' with popup STARTED"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,E.loginPopup({scopes:S,prompt:I})];case 2:return e=r.sent(),C("Fetch Azure AD 'token' with popup SUCCEEDED",e),C("Fetch Graph API 'access_token' in silent mode STARTED"),O(),[3,4];case 3:return t=r.sent(),C("Fetch Azure AD 'token' with popup FAILED",t,!0),y(t),[3,4];case 4:return[2]}})})},_=function(){C("Fetch Azure AD 'token' with redirect STARTED"),E.loginRedirect({scopes:S,prompt:I})},P=function(e){return s(void 0,void 0,void 0,function(){var t,r;return c(this,function(o){switch(o.label){case 0:return t=e.accessToken,C("Fetch Graph API user data STARTED"),[4,fetch("https://graph.microsoft.com/v1.0/me",{method:"GET",headers:{Authorization:"Bearer "+t}})];case 1:return[4,o.sent().json()];case 2:return r=o.sent(),C("Fetch Graph API user data SUCCEEDED",r),C("Login SUCCEEDED"),y(null,n(n({},r),e),E),[2]}})})};return u?l.default.createElement("div",{onClick:k},u):l.default.createElement(h.default,{buttonTheme:p||"light",buttonClassName:f,onClick:k})}},2540:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(1));t.default=function(e){var t=e.buttonTheme,r=e.buttonClassName,n=e.onClick,i=t.split("_"),a="dark"===i[0],s={cursor:"pointer"};return i[1]?o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"104",height:"41",style:s,className:r,onClick:n},o.default.createElement("path",{fill:a?"#2f2f2f":"#ffffff",d:"M0 0h104v41H0z"}),!a&&o.default.createElement("path",{fill:"#8c8c8c",d:"M103 1v39H1V1h102m1-1H0v41h104V0z"}),o.default.createElement("path",{fill:"#f25022",d:"M13 11h9v9h-9z"}),o.default.createElement("path",{fill:"#00a4ef",d:"M13 21h9v9h-9z"}),o.default.createElement("path",{fill:"#7fba00",d:"M23 11h9v9h-9z"}),o.default.createElement("path",{fill:"#ffb900",d:"M23 21h9v9h-9z"}),o.default.createElement("path",{fill:a?"#ffffff":"#5e5e5e",d:"M45.812 25.082v-1.794a2.77 2.77 0 0 0 .573.4 4.484 4.484 0 0 0 .706.3 5.486 5.486 0 0 0 .745.187 3.954 3.954 0 0 0 .687.065 2.928 2.928 0 0 0 1.634-.365 1.2 1.2 0 0 0 .537-1.062 1.167 1.167 0 0 0-.178-.649 1.939 1.939 0 0 0-.5-.5 5.412 5.412 0 0 0-.757-.435q-.435-.209-.932-.436-.533-.285-.994-.578a4.285 4.285 0 0 1-.8-.648 2.724 2.724 0 0 1-.533-.8 2.6 2.6 0 0 1-.194-1.047 2.416 2.416 0 0 1 .333-1.285 2.794 2.794 0 0 1 .877-.9 4.019 4.019 0 0 1 1.239-.528 5.906 5.906 0 0 1 1.418-.172 5.692 5.692 0 0 1 2.4.374v1.721a3.817 3.817 0 0 0-2.295-.645 4.093 4.093 0 0 0-.771.074 2.335 2.335 0 0 0-.687.241 1.5 1.5 0 0 0-.494.433 1.06 1.06 0 0 0-.189.637 1.221 1.221 0 0 0 .145.608 1.573 1.573 0 0 0 .428.468 4.321 4.321 0 0 0 .688.414c.27.134.584.28.939.436q.548.285 1.034.6a4.881 4.881 0 0 1 .856.7 3.075 3.075 0 0 1 .585.846 2.493 2.493 0 0 1 .215 1.058 2.625 2.625 0 0 1-.322 1.348 2.584 2.584 0 0 1-.866.892 3.786 3.786 0 0 1-1.254.5 6.959 6.959 0 0 1-1.5.155c-.176 0-.392-.014-.647-.04s-.518-.067-.786-.117a7.75 7.75 0 0 1-.76-.187 2.373 2.373 0 0 1-.58-.269zM55.109 16.426a1.021 1.021 0 0 1-.713-.272.891.891 0 0 1-.3-.688.917.917 0 0 1 .3-.7 1.009 1.009 0 0 1 .713-.278 1.041 1.041 0 0 1 .732.278.915.915 0 0 1 .3.7.9.9 0 0 1-.3.678 1.035 1.035 0 0 1-.732.282zm.841 9.074h-1.7V18h1.7zM64.979 24.9q0 4.131-4.146 4.131a6.166 6.166 0 0 1-2.551-.491v-1.554a4.712 4.712 0 0 0 2.332.7 2.341 2.341 0 0 0 2.668-2.628v-.818h-.029a2.938 2.938 0 0 1-4.733.436 4.046 4.046 0 0 1-.837-2.684 4.738 4.738 0 0 1 .9-3.04 2.988 2.988 0 0 1 2.471-1.128 2.38 2.38 0 0 1 2.2 1.216h.029V18h1.7zM63.3 22.064v-.973a1.91 1.91 0 0 0-.523-1.352 1.71 1.71 0 0 0-1.3-.559 1.789 1.789 0 0 0-1.51.714 3.223 3.223 0 0 0-.545 2 2.78 2.78 0 0 0 .523 1.769 1.675 1.675 0 0 0 1.385.662 1.8 1.8 0 0 0 1.426-.632 2.4 2.4 0 0 0 .544-1.629zM73.853 25.5h-1.7v-4.227q0-2.1-1.483-2.1a1.616 1.616 0 0 0-1.279.582 2.167 2.167 0 0 0-.505 1.469V25.5h-1.7V18h1.7v1.245h.029a2.669 2.669 0 0 1 2.428-1.421 2.257 2.257 0 0 1 1.863.795 3.57 3.57 0 0 1 .644 2.3zM80.892 16.426a1.017 1.017 0 0 1-.713-.272.889.889 0 0 1-.3-.688.915.915 0 0 1 .3-.7 1 1 0 0 1 .713-.278 1.038 1.038 0 0 1 .731.278.915.915 0 0 1 .3.7.9.9 0 0 1-.3.678 1.033 1.033 0 0 1-.731.282zm.84 9.074h-1.7V18h1.7zM90.614 25.5h-1.7v-4.227q0-2.1-1.483-2.1a1.62 1.62 0 0 0-1.28.582 2.167 2.167 0 0 0-.5 1.469V25.5h-1.7V18h1.7v1.245h.03a2.668 2.668 0 0 1 2.427-1.421 2.258 2.258 0 0 1 1.864.795 3.576 3.576 0 0 1 .643 2.3z"})):o.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"215",height:"41",style:s,className:r,onClick:n},o.default.createElement("path",{fill:a?"#2f2f2f":"#ffffff",d:"M0 0h215v41H0z"}),!a&&o.default.createElement("path",{fill:"#8c8c8c",d:"M214 1v39H1V1h213m1-1H0v41h215V0z"}),o.default.createElement("path",{fill:a?"#ffffff":"#5e5e5e",d:"M45.812 25.082v-1.794a2.77 2.77 0 0 0 .573.4 4.484 4.484 0 0 0 .706.3 5.486 5.486 0 0 0 .745.187 3.954 3.954 0 0 0 .687.065 2.928 2.928 0 0 0 1.634-.365 1.2 1.2 0 0 0 .537-1.062 1.167 1.167 0 0 0-.178-.649 1.939 1.939 0 0 0-.5-.5 5.412 5.412 0 0 0-.757-.435q-.435-.209-.932-.436-.533-.285-.994-.578a4.285 4.285 0 0 1-.8-.648 2.724 2.724 0 0 1-.533-.8 2.6 2.6 0 0 1-.194-1.047 2.416 2.416 0 0 1 .333-1.285 2.794 2.794 0 0 1 .877-.9 4.019 4.019 0 0 1 1.239-.528 5.906 5.906 0 0 1 1.418-.172 5.692 5.692 0 0 1 2.4.374v1.721a3.817 3.817 0 0 0-2.295-.645 4.093 4.093 0 0 0-.771.074 2.335 2.335 0 0 0-.687.241 1.5 1.5 0 0 0-.494.433 1.06 1.06 0 0 0-.189.637 1.221 1.221 0 0 0 .145.608 1.573 1.573 0 0 0 .428.468 4.321 4.321 0 0 0 .688.414c.27.134.584.28.939.436q.548.285 1.034.6a4.881 4.881 0 0 1 .856.7 3.075 3.075 0 0 1 .585.846 2.493 2.493 0 0 1 .215 1.058 2.625 2.625 0 0 1-.322 1.348 2.584 2.584 0 0 1-.866.892 3.786 3.786 0 0 1-1.254.5 6.959 6.959 0 0 1-1.5.155c-.176 0-.392-.014-.647-.04s-.518-.067-.786-.117a7.75 7.75 0 0 1-.76-.187 2.373 2.373 0 0 1-.58-.269zM55.109 16.426a1.021 1.021 0 0 1-.713-.272.891.891 0 0 1-.3-.688.917.917 0 0 1 .3-.7 1.009 1.009 0 0 1 .713-.278 1.041 1.041 0 0 1 .732.278.915.915 0 0 1 .3.7.9.9 0 0 1-.3.678 1.035 1.035 0 0 1-.732.282zm.841 9.074h-1.7V18h1.7zM64.979 24.9q0 4.131-4.146 4.131a6.166 6.166 0 0 1-2.551-.491v-1.554a4.712 4.712 0 0 0 2.332.7 2.341 2.341 0 0 0 2.668-2.628v-.818h-.029a2.938 2.938 0 0 1-4.733.436 4.046 4.046 0 0 1-.837-2.684 4.738 4.738 0 0 1 .9-3.04 2.988 2.988 0 0 1 2.471-1.128 2.38 2.38 0 0 1 2.2 1.216h.029V18h1.7zM63.3 22.064v-.973a1.91 1.91 0 0 0-.523-1.352 1.71 1.71 0 0 0-1.3-.559 1.789 1.789 0 0 0-1.51.714 3.223 3.223 0 0 0-.545 2 2.78 2.78 0 0 0 .523 1.769 1.675 1.675 0 0 0 1.385.662 1.8 1.8 0 0 0 1.426-.632 2.4 2.4 0 0 0 .544-1.629zM73.853 25.5h-1.7v-4.227q0-2.1-1.483-2.1a1.616 1.616 0 0 0-1.279.582 2.167 2.167 0 0 0-.505 1.469V25.5h-1.7V18h1.7v1.245h.029a2.669 2.669 0 0 1 2.428-1.421 2.257 2.257 0 0 1 1.863.795 3.57 3.57 0 0 1 .644 2.3zM80.892 16.426a1.017 1.017 0 0 1-.713-.272.889.889 0 0 1-.3-.688.915.915 0 0 1 .3-.7 1 1 0 0 1 .713-.278 1.038 1.038 0 0 1 .731.278.915.915 0 0 1 .3.7.9.9 0 0 1-.3.678 1.033 1.033 0 0 1-.731.282zm.84 9.074h-1.7V18h1.7zM90.614 25.5h-1.7v-4.227q0-2.1-1.483-2.1a1.62 1.62 0 0 0-1.28.582 2.167 2.167 0 0 0-.5 1.469V25.5h-1.7V18h1.7v1.245h.03a2.668 2.668 0 0 1 2.427-1.421 2.258 2.258 0 0 1 1.864.795 3.576 3.576 0 0 1 .643 2.3zM106.865 18l-2.208 7.5h-1.776l-1.36-5.083a3.291 3.291 0 0 1-.1-.659h-.029a3.018 3.018 0 0 1-.132.644l-1.477 5.1h-1.741l-2.2-7.5H97.6l1.36 5.405a3.308 3.308 0 0 1 .087.645h.053a3.384 3.384 0 0 1 .117-.659L100.725 18h1.593l1.345 5.428a3.832 3.832 0 0 1 .095.644h.052a3.3 3.3 0 0 1 .109-.644l1.33-5.428zM108.977 16.426a1.017 1.017 0 0 1-.713-.272.889.889 0 0 1-.3-.688.915.915 0 0 1 .3-.7 1 1 0 0 1 .713-.278 1.038 1.038 0 0 1 .731.278.915.915 0 0 1 .3.7.9.9 0 0 1-.3.678 1.033 1.033 0 0 1-.731.282zm.84 9.074h-1.7V18h1.7zM115.979 25.42a2.944 2.944 0 0 1-1.307.248q-2.18 0-2.179-2.094v-4.241h-1.25V18h1.25v-1.736l1.7-.483V18h1.79v1.333h-1.79v3.75a1.478 1.478 0 0 0 .242.952 1 1 0 0 0 .8.285 1.16 1.16 0 0 0 .745-.248zM124.094 25.5h-1.7v-4.1q0-2.226-1.483-2.226a1.555 1.555 0 0 0-1.258.644 2.573 2.573 0 0 0-.511 1.649V25.5h-1.7V14.4h1.7v4.849h.029a2.679 2.679 0 0 1 2.428-1.421q2.492 0 2.492 3.055zM141.719 25.5h-1.726v-6.8q0-.835.1-2.043h-.03a6.992 6.992 0 0 1-.285.988l-3.126 7.855h-1.2l-3.136-7.793a7.371 7.371 0 0 1-.277-1.047h-.029q.059.63.058 2.058V25.5h-1.608V15h2.449l2.756 7a10.415 10.415 0 0 1 .409 1.2h.036c.181-.551.327-.962.439-1.23l2.808-6.97h2.362zM144.964 16.426a1.019 1.019 0 0 1-.713-.272.892.892 0 0 1-.3-.688.918.918 0 0 1 .3-.7 1.007 1.007 0 0 1 .713-.278 1.038 1.038 0 0 1 .731.278.911.911 0 0 1 .3.7.9.9 0 0 1-.3.678 1.033 1.033 0 0 1-.731.282zm.841 9.074h-1.7V18h1.7zM153.378 25.156a4.185 4.185 0 0 1-2.127.52 3.6 3.6 0 0 1-2.69-1.044 3.7 3.7 0 0 1-1.024-2.706 4.074 4.074 0 0 1 1.1-2.978 3.93 3.93 0 0 1 2.942-1.124 4.281 4.281 0 0 1 1.806.36v1.582a2.73 2.73 0 0 0-1.667-.586 2.312 2.312 0 0 0-1.762.728 2.669 2.669 0 0 0-.687 1.908 2.54 2.54 0 0 0 .647 1.838 2.291 2.291 0 0 0 1.736.674 2.708 2.708 0 0 0 1.725-.652zM159.4 19.619a1.4 1.4 0 0 0-.884-.242 1.514 1.514 0 0 0-1.258.682 3.047 3.047 0 0 0-.5 1.852V25.5h-1.7V18h1.7v1.545h.029a2.6 2.6 0 0 1 .764-1.233 1.72 1.72 0 0 1 1.151-.444 1.425 1.425 0 0 1 .7.14zM163.788 25.676a3.71 3.71 0 0 1-2.767-1.051 3.8 3.8 0 0 1-1.035-2.787 3.7 3.7 0 0 1 3.985-4.014 3.581 3.581 0 0 1 2.733 1.033 3.994 3.994 0 0 1 .98 2.864 3.938 3.938 0 0 1-1.056 2.875 3.8 3.8 0 0 1-2.84 1.08zm.08-6.5a1.932 1.932 0 0 0-1.571.7 2.913 2.913 0 0 0-.578 1.919 2.744 2.744 0 0 0 .585 1.856 1.957 1.957 0 0 0 1.564.678 1.862 1.862 0 0 0 1.539-.666 2.95 2.95 0 0 0 .537-1.9 2.99 2.99 0 0 0-.537-1.911 1.851 1.851 0 0 0-1.539-.672zM168.94 25.266v-1.575a3.383 3.383 0 0 0 2.1.725q1.535 0 1.535-.908a.714.714 0 0 0-.132-.436 1.263 1.263 0 0 0-.354-.318 2.864 2.864 0 0 0-.526-.25c-.2-.072-.428-.155-.677-.248a7.074 7.074 0 0 1-.829-.389 2.526 2.526 0 0 1-.615-.465 1.758 1.758 0 0 1-.369-.59 2.168 2.168 0 0 1-.124-.769 1.775 1.775 0 0 1 .256-.955 2.224 2.224 0 0 1 .687-.7 3.294 3.294 0 0 1 .979-.425 4.49 4.49 0 0 1 1.129-.139 5.163 5.163 0 0 1 1.856.315v1.487a3.127 3.127 0 0 0-1.812-.542 2.323 2.323 0 0 0-.582.066 1.477 1.477 0 0 0-.442.183.893.893 0 0 0-.285.282.677.677 0 0 0-.1.363.779.779 0 0 0 .1.41.936.936 0 0 0 .3.3 2.675 2.675 0 0 0 .482.234q.282.105.648.23a9.5 9.5 0 0 1 .866.4 2.872 2.872 0 0 1 .654.465 1.789 1.789 0 0 1 .416.6 2.034 2.034 0 0 1 .147.81 1.855 1.855 0 0 1-.263 1 2.212 2.212 0 0 1-.7.7 3.28 3.28 0 0 1-1.013.413 5.2 5.2 0 0 1-1.209.136 5.1 5.1 0 0 1-2.123-.41zM179.183 25.676a3.711 3.711 0 0 1-2.768-1.051 3.8 3.8 0 0 1-1.034-2.787 3.7 3.7 0 0 1 3.984-4.014 3.585 3.585 0 0 1 2.734 1.033 3.993 3.993 0 0 1 .979 2.864 3.934 3.934 0 0 1-1.056 2.875 3.794 3.794 0 0 1-2.839 1.08zm.08-6.5a1.934 1.934 0 0 0-1.572.7 2.919 2.919 0 0 0-.578 1.919 2.749 2.749 0 0 0 .585 1.856 1.959 1.959 0 0 0 1.565.678 1.864 1.864 0 0 0 1.539-.666 2.956 2.956 0 0 0 .537-1.9 3 3 0 0 0-.537-1.911 1.852 1.852 0 0 0-1.539-.672zM188.787 15.781a1.523 1.523 0 0 0-.782-.2q-1.235 0-1.235 1.4V18h1.74v1.333h-1.733V25.5h-1.7v-6.167H183.8V18h1.279v-1.216a2.37 2.37 0 0 1 .775-1.871 2.817 2.817 0 0 1 1.937-.684 2.866 2.866 0 0 1 .994.138zM193.94 25.42a2.944 2.944 0 0 1-1.307.248q-2.179 0-2.179-2.094v-4.241H189.2V18h1.25v-1.736l1.7-.483V18h1.79v1.333h-1.79v3.75a1.472 1.472 0 0 0 .242.952 1 1 0 0 0 .8.285 1.162 1.162 0 0 0 .745-.248z"}),o.default.createElement("path",{fill:"#f25022",d:"M13 11h9v9h-9z"}),o.default.createElement("path",{fill:"#00a4ef",d:"M13 21h9v9h-9z"}),o.default.createElement("path",{fill:"#7fba00",d:"M23 11h9v9h-9z"}),o.default.createElement("path",{fill:"#ffb900",d:"M23 21h9v9h-9z"}))}},2541:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.checkToIE=t.getLogger=t.getScopes=t.getUserAgentApp=void 0;var o=r(2629),i=/[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}/;t.getUserAgentApp=function(e){var t=e.clientId,r=e.tenantUrl,a=e.redirectUri,s=e.postLogoutRedirectUri,c=e.useLocalStorageCache;if(t&&i.test(t))return new o.UserAgentApplication({auth:n(n(n(n({},a&&{redirectUri:a}),r&&{authority:r}),s&&{postLogoutRedirectUri:s}),{clientId:t,validateAuthority:!0,navigateToLoginRequestUrl:!1}),cache:n({},c?{cacheLocation:"localStorage"}:{cacheLocation:"sessionStorage"})})};t.getScopes=function(e){var t=e||[];return t.find(function(e){return"user.read"===e.toLowerCase()})||t.push("user.read"),t};t.getLogger=function(e){return function(t,r,n){if(e){var o="background-color: "+(n?"#990000":"#009900")+"; color: #ffffff; font-weight: 700; padding: 2px";console.groupCollapsed("MSLogin debug"),console.log("%c"+t,o),r&&console.log(r.message||r),console.groupEnd()}}};t.checkToIE=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0}},2629:function(e,t,r){"use strict";r.r(t);var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function c(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}var u,l=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?a+=o[i]:"y"===n[s]?(i&=3,a+=o[i|=8]):a+=n[s];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e}(),h=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!1,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!1,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}(),d="sessionStorage";!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(u||(u={}));var p,f,g,m="id_token",y="token",v="id_token token";!function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction.status",e.REDIRECT_REQUEST="redirect_request"}(p||(p={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(f||(f={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(g||(g={}));var b;!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(b||(b={}));var I,w=[b.SID,b.LOGIN_HINT],T="GET",E={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},S="msalIdTokenFrame",C="msalRenewFrame",k={code:"unexpected_error",desc:"Unexpected error in authentication."},A={code:"no_window_object",desc:"No window object available. Details:"},O=function(e){function t(r,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=r,o.errorMessage=n,o.name="AuthError",o}return o(t,e),t.createUnexpectedError=function(e){return new t(k.code,k.desc+": "+e)},t.createNoWindowObjectError=function(e){return new t(A.code,A.desc+" "+e)},t}(Error),R=function(){function e(){}return e.isEmpty=function(e){return"undefined"===typeof e||!e||0===e.length},e.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(r){return null}},e}(),_={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},P={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},N={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},M={code:"invalid_id_token",desc:"Invalid ID token format."},x={code:"invalid_state_error",desc:"Invalid state."},L={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},U={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},j={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},q={code:"user_cancelled",desc:"User cancelled the flow."},D={code:"callback_error",desc:"Error occurred in token received callback function."},H={code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},F={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},K={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},z={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},G={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},V={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},W={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},B={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},Q={code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},J={code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"},$=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t.createEndpointResolutionError=function(e){var r=_.desc;return e&&!R.isEmpty(e)&&(r+=" Details: "+e),new t(_.code,r)},t.createPopupWindowError=function(e){var r=P.desc;return e&&!R.isEmpty(e)&&(r+=" Details: "+e),new t(P.code,r)},t.createTokenRenewalTimeoutError=function(){return new t(N.code,N.desc)},t.createInvalidIdTokenError=function(e){return new t(M.code,M.desc+" Given token: "+e)},t.createInvalidStateError=function(e,r){return new t(x.code,x.desc+" "+e+", state expected : "+r+".")},t.createNonceMismatchError=function(e,r){return new t(L.code,L.desc+" "+e+", nonce expected : "+r+".")},t.createLoginInProgressError=function(){return new t(U.code,U.desc)},t.createAcquireTokenInProgressError=function(){return new t(j.code,j.desc)},t.createUserCancelledError=function(){return new t(q.code,q.desc)},t.createErrorInCallbackFunction=function(e){return new t(D.code,D.desc+" "+e+".")},t.createUserLoginRequiredError=function(){return new t(H.code,H.desc)},t.createUserDoesNotExistError=function(){return new t(F.code,F.desc)},t.createClientInfoDecodingError=function(e){return new t(K.code,K.desc+" Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t(z.code,z.desc+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(G.code,G.desc+" Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t(V.code,V.desc+" Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t(W.code,W.desc+" Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t(B.code,B.desc)},t.createCacheParseError=function(e){var r="invalid key: "+e+", "+Q.desc;return new t(Q.code,r)},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t(J.code,J.desc)},t}(O),X={code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},Y={code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},Z={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},ee={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},te={code:"scopes_required",desc:"Scopes are required to obtain an access token."},re={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},ne={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},oe={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},ie={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},ae={code:"authority_uri_insecure",desc:"Authority URIs must use https."},se={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},ce={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},ue={code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},le={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},he={code:"empty_request_error",desc:"Request object is required."},de={code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},pe={code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},fe={code:"sso_silent_error",desc:"request must contain either sid or login_hint"},ge={code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."},me=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t.createNoSetConfigurationError=function(){return new t(X.code,""+X.desc)},t.createStorageNotSupportedError=function(e){return new t(Y.code,Y.desc+" Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(Z.code,Z.desc)},t.createInvalidCallbackObjectError=function(e){return new t(ee.code,ee.desc+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(re.code,re.desc+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(ne.code,ne.desc+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t(te.code,te.desc+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t(oe.code,oe.desc+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(le.code,le.desc+" Given value: "+e)},t.createEmptyRequestError=function(){var e=he;return new t(e.code,e.desc)},t.createInvalidCorrelationIdError=function(){return new t(de.code,de.desc)},t.createKnownAuthoritiesNotSetError=function(){return new t(ue.code,ue.desc)},t.createInvalidAuthorityTypeError=function(){return new t(ie.code,ie.desc)},t.createUntrustedAuthorityError=function(e){return new t(ce.code,ce.desc+" Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var r=pe,n=r.code,o=r.desc,i={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(n,o+" mising values: "+Object.keys(i).reduce(function(t,r){return e[r]?t:t.concat([r+" ("+i[r]+")"])},[]).join(","))},t.createSsoSilentError=function(){return new t(fe.code,fe.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(ge.code,ge.desc)},t}($),ye=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(c(e)),n=this.trimAndConvertArrayToLowerCase(c(t)),o=0;o<n.length;o++)if(r.indexOf(n[o].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(c(e));return this.trimAndConvertArrayToLowerCase(c(t)).every(function(e){return r.indexOf(e.toString().toLowerCase())>=0})},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map(function(e){return t.trimAndConvertToLowerCase(e)})},e.trimScopes=function(e){return e.map(function(e){return e.trim()})},e.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter(function(e){return e!==r})},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw me.createScopesNonArrayError(e);if(e.length<1&&t)throw me.createEmptyScopesArrayError(e.toString())}else if(t)throw me.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(h.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(c(t)):null,n=this.trimAndConvertArrayToLowerCase(c(e));return r?c(n,r):n}return null},e.onlyContainsOidcScopes=function(e){var t=e.length,r=0;return e.indexOf(h.openidScope)>-1&&(r+=1),e.indexOf(h.profileScope)>-1&&(r+=1),t>0&&t===r},e.containsAnyOidcScopes=function(e){var t=e.indexOf(h.openidScope)>-1,r=e.indexOf(h.profileScope)>-1;return t||r},e.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},e.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(h.openidScope)&&t.push(h.openidScope),-1===t.indexOf(h.profileScope)&&t.push(h.profileScope),t},e.removeDefaultScopes=function(e){return e.filter(function(e){return e!==h.openidScope&&e!==h.profileScope})},e.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?h.oidcScopes:e},e}(),ve=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=ye.appendDefaultScopes(e.scopes),r=[];return r.push("response_type="+e.responseType),r.push("scope="+encodeURIComponent(ye.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){var r=e.toLowerCase(),n=this.GetUrlComponents(r),o=n.PathSegments;return!t||0===o.length||o[0]!==h.common&&o[0]!==b.ORGANIZATIONS&&o[0]!==b.CONSUMERS||(o[0]=t),this.constructAuthorityUriFromObject(n,o)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===h.common},e.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===b.ORGANIZATIONS},e.isConsumersAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===b.CONSUMERS},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter(function(e){return e&&e.length>0}),n.PathSegments=o,r[6]&&(n.Search=r[6]),r[8]&&(n.Hash=r[8]),n},e.CanonicalizeUri=function(t){if(t){var r=t.toLowerCase();return e.endsWith(r,"/")||(r+="/"),r}return t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(R.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(u.ERROR_DESCRIPTION)||r.hasOwnProperty(u.ERROR)||r.hasOwnProperty(u.ACCESS_TOKEN)||r.hasOwnProperty(u.ID_TOKEN)},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return l.deserialize(r)},e.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e}(),be=function(){return function(e,t,r,n,o){this.authority=ve.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=l.base64Encode(n)+"."+l.base64Encode(o)}}(),Ie=function(){return function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n}}(),we="1.4.18",Te=function(){function e(e,t,r,n,o,i,a){this.authorityInstance=e,this.clientId=t,this.nonce=l.createNewGuid(),this.scopes=o?c(o):h.oidcScopes,this.scopes=ye.trimScopes(this.scopes),this.state=i,this.correlationId=a,this.xClientSku="MSAL.JS",this.xClientVer=we,this.responseType=r,this.redirectUri=n}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!1,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n,o){var i={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(i=this.constructUnifiedCacheQueryParameter(r,null))),n&&(i=this.constructUnifiedCacheQueryParameter(null,n)),i=this.addHintParameters(t,i);var a=r?r.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(a,o)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n,o;if(e)if(e.account){var i=e.account;(null===(r=i.idTokenClaims)||void 0===r?void 0:r.login_hint)?(n=b.LOGIN_HINT,o=i.idTokenClaims.login_hint):i.sid?(n=b.SID,o=i.sid):i.userName&&(n=b.LOGIN_HINT,o=i.userName)}else e.sid?(n=b.SID,o=e.sid):e.loginHint&&(n=b.LOGIN_HINT,o=e.loginHint);else t&&t.hasOwnProperty(h.upn)&&(n=b.ID_TOKEN,o=t.upn);return this.addSSOParameter(n,o)},e.prototype.addHintParameters=function(e,t){var r,n,o=t;return e&&(o[b.SID]||o[b.LOGIN_HINT]||((null===(r=e.idTokenClaims)||void 0===r?void 0:r.login_hint)?o=this.addSSOParameter(b.LOGIN_HINT,null===(n=e.idTokenClaims)||void 0===n?void 0:n.login_hint,o):e.sid&&this.promptValue===E.NONE?o=this.addSSOParameter(b.SID,e.sid,o):e.userName&&(o=this.addSSOParameter(b.LOGIN_HINT,e.userName,o)))),o},e.prototype.addSSOParameter=function(e,t,r){var n=r||{};if(!t)return n;switch(e){case b.SID:n[b.SID]=t;break;case b.ID_TOKEN:case b.LOGIN_HINT:n[b.LOGIN_HINT]=t}return n},e.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach(function(n){n===h.domain_hint&&(t||e[b.SID])||(r?r+="&"+n+"="+encodeURIComponent(e[n]):r=n+"="+encodeURIComponent(e[n]))}),r},e.isSSOParam=function(e){return!(!e||!(e.account||e.sid||e.loginHint))},e.determineResponseType=function(e,t){return ye.onlyContainsOidcScopes(t)?m:e?this.responseTypeForMatchingAccounts(t):v},e.responseTypeForMatchingAccounts=function(e){return ye.containsAnyOidcScopes(e)?v:y},e}(),Ee=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise(function(r,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(){var e;(i.status<200||i.status>=300)&&o(n.handleError(i.responseText));try{e=JSON.parse(i.responseText)}catch(a){o(n.handleError(i.responseText))}var t={statusCode:i.status,body:e};r(t)},i.onerror=function(){o(i.status)},t!==T)throw"not implemented";i.send()})},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(r){return e}},e}(),Se=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,r){t&&!this.getTrustedHostList().length&&r.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})},e.getAliases=function(e,t,r){return a(this,void 0,void 0,function(){var n,o,i,a;return s(this,function(s){return n=new Ee,o=T,i="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize",a=t.createAndStartHttpEvent(r,o,i,"getAliases"),[2,n.sendRequestAsync(i,o,!0).then(function(e){return a.httpResponseStatus=e.statusCode,t.stopEvent(a),e.body.metadata}).catch(function(e){throw a.serverErrorCode=e,t.stopEvent(a),e})]})})},e.setTrustedAuthoritiesFromNetwork=function(t,r,n){return a(this,void 0,void 0,function(){var o;return s(this,function(i){switch(i.label){case 0:return[4,this.getAliases(t,r,n)];case 1:return i.sent().forEach(function(t){t.aliases.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})}),o=ve.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(o)&&e.TrustedHostList.push(o.toLowerCase()),[2]}})})},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(I||(I={}));var Ce,ke=function(){function e(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}return e.isAdfs=function(e){var t=ve.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===h.ADFS},Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return e.isAdfs(this.canonicalAuthority)?I.Adfs:I.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=ve.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=ve.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===I.Adfs?this.CanonicalAuthority+".well-known/openid-configuration":this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(t){throw ie}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw ae;if(!e.PathSegments||e.PathSegments.length<1)throw se},e.prototype.DiscoverEndpoints=function(e,t,r){var n=new Ee,o=T,i=t.createAndStartHttpEvent(r,o,e,"openIdConfigurationEndpoint");return n.sendRequestAsync(e,o,!0).then(function(e){return i.httpResponseStatus=e.statusCode,t.stopEvent(i),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}}).catch(function(e){throw i.serverErrorCode=e,t.stopEvent(i),e})},e.prototype.resolveEndpointsAsync=function(e,t){return a(this,void 0,void 0,function(){var r,n,o;return s(this,function(i){switch(i.label){case 0:return this.IsValidationEnabled?(r=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==Se.getTrustedHostList().length?[3,2]:[4,Se.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:i.sent(),i.label=2;case 2:if(!Se.IsInTrustedHostList(r))throw me.createUntrustedAuthorityError(r);i.label=3;case 3:return n=this.GetOpenIdConfigurationEndpoint(),o=this,[4,this.DiscoverEndpoints(n,e,t)];case 4:return o.tenantDiscoveryResponse=i.sent(),[2,this.tenantDiscoveryResponse]}})})},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}(),Ae=function(){function e(t,r){if(!t||R.isEmpty(t))return this.uid="",void(this.utid="");try{var n=l.base64Decode(t),o=JSON.parse(n);o&&(o.hasOwnProperty("uid")&&(this.uid=r?e.stripPolicyFromUid(o.uid,r):o.uid),o.hasOwnProperty("utid")&&(this.utid=o.utid))}catch(i){throw $.createClientInfoDecodingError(i)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!1,configurable:!0}),e.createClientInfoFromIdToken=function(t,r){var n={uid:t.subject,utid:""};return new e(l.base64Encode(JSON.stringify(n)),r)},e.stripPolicyFromUid=function(e,t){var r=e.split("-"),n=t.split("/").reverse(),o="";return R.isEmpty(n[0])?n.length>1&&(o=n[1]):o=n[0],r[r.length-1]===o?r.slice(0,r.length-1).join("-"):e},e.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return l.base64Encode(e)},e}(),Oe=function(){function e(){}return e.parseExpiresIn=function(e){return parseInt(e||"3599",10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}(),Re=function(){function e(){}return e.decodeJwt=function(e){if(R.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.validateExpirationIsWithinOffset=function(e,t){var r=t||300;return e&&e>Oe.now()+r},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=l.base64Decode(r);return n?JSON.parse(n):null}catch(o){}return null},e}(),_e=function(){return function(e){if(R.isEmpty(e))throw $.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=Re.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(t){throw $.createIdTokenParsingError(t)}}}(),Pe=function(){return function(e,t){this.key=e,this.value=t}}(),Ne=function(){function e(e){if(!window)throw O.createNoWindowObjectError("Browser storage class could not find window object");if(!("undefined"!==typeof window[e]&&null!==window[e]))throw me.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),Me=function(){function e(){}return e.validateRequest=function(e,t,r,n){if(!t&&!e)throw me.createEmptyRequestError();var o,a;e&&(o=t?ye.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,ye.validateInputScope(o,!t),o=ye.translateClientIdIfSingleScope(o,r),this.validatePromptParameter(e.prompt),a=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var s=this.validateAndGenerateState(e&&e.state,n),c=this.validateAndGenerateCorrelationId(e&&e.correlationId);return i(i({},e),{extraQueryParameters:a,scopes:o,state:s,correlationId:c})},e.validatePromptParameter=function(e){if(e&&[E.LOGIN,E.SELECT_ACCOUNT,E.CONSENT,E.NONE].indexOf(e)<0)throw me.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var r=i({},e);return r?(t&&delete r[h.claims],w.forEach(function(e){r[e]&&delete r[e]}),r):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(t){throw me.createClaimsRequestParsingError(t)}},e.validateAndGenerateState=function(t,r){return R.isEmpty(t)?e.generateLibraryState(r):""+e.generateLibraryState(r)+h.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:l.createNewGuid(),ts:Oe.now(),method:e},r=JSON.stringify(t);return l.base64Encode(r)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(h.resourceDelimiter)[0];if(l.isGuid(t))return{id:t,ts:Oe.now(),method:h.interactionTypeRedirect};try{var r=l.base64Decode(t);return JSON.parse(r)}catch(n){throw $.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!l.isGuid(e))throw me.createInvalidCorrelationIdError();return l.isGuid(e)?e:l.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+h.resourceDelimiter+e.authority},e}(),xe=function(e){function t(t,r,n){var o=e.call(this,r)||this;return o.temporaryCache=new Ne(d),o.clientId=t,o.rollbackEnabled=!0,o.migrateCacheEntries(n),o}return o(t,e),t.prototype.migrateCacheEntries=function(t){var r,n=this,o=h.cachePrefix+"."+f.IDTOKEN,i=h.cachePrefix+"."+f.CLIENT_INFO,a=h.cachePrefix+"."+g.ERROR,s=h.cachePrefix+"."+g.ERROR_DESC,c=e.prototype.getItem.call(this,o);if(c)try{r=new _e(c)}catch(l){return}if(r&&r.claims&&r.claims.aud===this.clientId){var u=[c,e.prototype.getItem.call(this,i),e.prototype.getItem.call(this,a),e.prototype.getItem.call(this,s)];[f.IDTOKEN,f.CLIENT_INFO,g.ERROR,g.ERROR_DESC].forEach(function(e,r){return n.duplicateCacheEntry(e,u[r],t)})}},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+h.cachePrefix)||0===e.indexOf(h.adalIdToken)?e:t?h.cachePrefix+"."+this.clientId+"."+e:h.cachePrefix+"."+e}},t.prototype.matchKeyForType=function(e,t,r,n){var o=R.validateAndParseJsonCacheKey(e);if(!o)return null;var i=e.match(t)&&e.match(r),a=!1;switch(n){case u.ACCESS_TOKEN:a=!!e.match(h.scopes);break;case u.ID_TOKEN:a=!e.match(h.scopes)}return i&&a?o:null},t.prototype.setItem=function(t,r,n){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&!n&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},t.prototype.removeItem=function(t){this.temporaryCache.removeItem(this.generateCacheKey(t,!0)),e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.setTemporaryItem=function(e,t,r){this.temporaryCache.setItem(this.generateCacheKey(e,!0),t,r)},t.prototype.getTemporaryItem=function(e,t){return this.temporaryCache.getItem(this.generateCacheKey(e,!0),t)},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(h.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var r=this,n=t&&Me.parseLibraryState(t).id,o=this.tokenRenewalInProgress(t),i=window[this.cacheLocation];n&&!o&&Object.keys(i).forEach(function(t){-1!==t.indexOf(n)&&(r.removeItem(t),e.prototype.clearItemCookie.call(r,t))}),this.setInteractionInProgress(!1),this.removeItem(p.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,r,n){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllTokensByType=function(e,t,r){var n=this;return Object.keys(window[this.cacheLocation]).reduce(function(o,i){var a=n.matchKeyForType(i,e,t,r);if(a){var s=n.getItem(i);if(s)try{var c=new Pe(a,JSON.parse(s));return o.concat([c])}catch(u){return o}}return o},[])},t.prototype.getAllAccessTokens=function(e,t){return this.getAllTokensByType(e,t,u.ACCESS_TOKEN)},t.prototype.getAllIdTokens=function(e,t){return this.getAllTokensByType(e,t,u.ID_TOKEN)},t.prototype.getAllTokens=function(e,t){return c(this.getAllAccessTokens(e,t),this.getAllIdTokens(e,t))},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){return this.getTemporaryItem(this.generateCacheKey(p.INTERACTION_STATUS,!1))},t.prototype.setInteractionInProgress=function(e){if(e){if(this.isInteractionInProgress(!1))throw $.createAcquireTokenInProgressError();this.setTemporaryItem(this.generateCacheKey(p.INTERACTION_STATUS,!1),this.clientId)}else!e&&this.isInteractionInProgress(!0)&&this.removeItem(this.generateCacheKey(p.INTERACTION_STATUS,!1))},t.prototype.tokenRenewalInProgress=function(e){var r=this.getItem(t.generateTemporaryCacheKey(p.RENEW_STATUS,e));return!(!r||r!==h.inProgress)},t.prototype.clearMsalCookie=function(r){var n=this;r?(this.clearItemCookie(t.generateTemporaryCacheKey(p.NONCE_IDTOKEN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(p.STATE_LOGIN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(p.LOGIN_REQUEST,r)),this.clearItemCookie(t.generateTemporaryCacheKey(p.STATE_ACQ_TOKEN,r))):document.cookie.split(";").forEach(function(t){var r=t.trim().split("=")[0];r.indexOf(h.cachePrefix)>-1&&e.prototype.clearItemCookie.call(n,r)})},t.generateAcquireTokenAccountKey=function(e,t){var r=Me.parseLibraryState(t).id;return""+p.ACQUIRE_TOKEN_ACCOUNT+h.resourceDelimiter+e+h.resourceDelimiter+r},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(p.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var r=Me.parseLibraryState(t).id;return""+e+h.resourceDelimiter+r},t}(Ne),Le=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,r){var n,o=t.objectId||t.subject,i=r?r.uid:"",a=r?r.utid:"";return R.isEmpty(i)||(n=R.isEmpty(a)?l.base64Encode(i):l.base64Encode(i)+"."+l.base64Encode(a)),new e(o,n,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}(),Ue=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+h.resourceDelimiter+t},e.monitorIframeForHash=function(t,r,n,o){return new Promise(function(i,a){var s=Oe.relativeNowMs()+r;o.verbose("monitorWindowForIframe polling started");var c=setInterval(function(){if(Oe.relativeNowMs()>s)return o.error("monitorIframeForHash unable to find hash in url, timing out"),o.errorPii("monitorIframeForHash polling timed out for url: "+n),clearInterval(c),void a($.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(r){}e&&ve.urlContainsHash(e)&&(o.verbose("monitorIframeForHash found url in hash"),clearInterval(c),i(t.location.hash))},e.POLLING_INTERVAL_MS)})},e.monitorPopupForHash=function(t,r,n,o){return new Promise(function(i,a){var s=r/e.POLLING_INTERVAL_MS,c=0;o.verbose("monitorWindowForHash polling started");var u=setInterval(function(){if(t.closed)return o.error("monitorWindowForHash window closed"),clearInterval(u),void a($.createUserCancelledError());var r;try{r=t.location.href}catch(h){}if(r&&"about:blank"!==r)if(c++,r&&ve.urlContainsHash(r)){o.verbose("monitorPopupForHash found url in hash"),clearInterval(u);var l=t.location.hash;e.clearUrlFragment(t),i(l)}else c>s&&(o.error("monitorPopupForHash unable to find hash in url, timing out"),o.errorPii("monitorPopupForHash polling timed out for url: "+n),clearInterval(u),a($.createTokenRenewalTimeoutError()))},e.POLLING_INTERVAL_MS)})},e.loadFrame=function(e,t,r,n){var o=this;return n.infoPii("LoadFrame: "+t),new Promise(function(i,a){setTimeout(function(){var r=o.loadFrameSync(e,t,n);r?i(r):a("Unable to load iframe with name: "+t)},r)})},e.loadFrameSync=function(t,r,n){var o=e.addHiddenIFrame(r,n);return o?(""!==o.src&&"about:blank"!==o.src||(o.src=t,n.infoPii("Frame Name : "+r+" Navigated to: "+t)),o):null},e.addHiddenIFrame=function(e,t){if("undefined"===typeof e)return null;t.info("Add msal iframe to document"),t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(r)t.verbose("Add msal iframe already exists");else{t.verbose("Add msal iframe does not exist");var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n)}return r},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map(function(e,r){return t.item(r)}).filter(function(t){try{return t.contentWindow.location.hash===e}catch(r){return!1}})[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter(function(e){try{return e.location.hash===t}catch(r){return!1}})[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach(function(e){return e.close()})},e.blockReloadInHiddenIframes=function(){if(ve.urlContainsHash(window.location.hash)&&e.isInIframe())throw $.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(p.REDIRECT_REQUEST);if(t&&!ve.urlContainsHash(window.location.hash)){var r=t.split(h.resourceDelimiter);r.shift();var n=r.length>0?r.join(h.resourceDelimiter):null;e.resetTempCacheItems(n)}},e.clearUrlFragment=function(e){e.location.hash="","function"===typeof e.history.replaceState&&e.history.replaceState(null,null,""+e.location.pathname+e.location.search)},e.POLLING_INTERVAL_MS=50,e}(),je=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),i(i({},e),{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e.buildAuthResponse=function(t,r,n,o,a,s){switch(n.responseType){case m:var c=i(i({},r),{tokenType:u.ID_TOKEN,account:o,scopes:a,accountState:s});return(c=e.setResponseIdToken(c,t)).idToken?c:null;case v:var l=e.setResponseIdToken(r,t);return l&&l.accessToken&&l.idToken?l:null;case y:return e.setResponseIdToken(r,t);default:return null}},e}(),qe=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,r){return a(this,void 0,void 0,function(){var n;return s(this,function(o){switch(o.label){case 0:return[4,e.resolveEndpointsAsync(t,r)];case 1:return n=o.sent(),this.metadataMap.set(e.CanonicalAuthority,n),[2,n]}})})},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw me.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(n){throw me.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,r){return R.isEmpty(e)?null:(r&&this.saveMetadataFromConfig(e,r),new ke(e,t,this.metadataMap.get(e)))},e.metadataMap=new Map,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(Ce||(Ce={}));var De=function(){function e(e,t){void 0===t&&(t={}),this.level=Ce.Info;var r=t.correlationId,n=void 0===r?"":r,o=t.level,i=void 0===o?Ce.Info:o,a=t.piiLoggingEnabled,s=void 0!==a&&a;this.localCallback=e,this.correlationId=n,this.level=i,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var n,o=(new Date).toUTCString();n=R.isEmpty(this.correlationId)?o+":"+we+"-"+Ce[e]+(r?"-pii":"")+" "+t:o+":"+this.correlationId+"-"+we+"-"+Ce[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,n,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(Ce.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(Ce.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(Ce.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(Ce.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(Ce.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(Ce.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(Ce.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(Ce.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),He={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return ve.getCurrentUrl()},postLogoutRedirectUri:function(){return ve.getCurrentUrl()},navigateToLoginRequestUrl:!0},Fe={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},Ke={logger:new De(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},ze={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};var Ge={code:"server_unavailable",desc:"Server is temporarily unavailable."},Ve={code:"unknown_server_error"},We=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t.createServerUnavailableError=function(){return new t(Ge.code,Ge.desc)},t.createUnknownServerError=function(e){return new t(Ve.code,e)},t}(O),Be={code:"interaction_required"},Qe={code:"consent_required"},Je={code:"login_required"},$e=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t.isInteractionRequiredError=function(e){var t=[Be.code,Qe.code,Je.code];return e&&t.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(Je.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(Be.code,e)},t.createConsentRequiredAuthError=function(e){return new t(Qe.code,e)},t}(We);function Xe(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var Ye,Ze,et,tt="event_name",rt="elapsed_time",nt={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"},ot=function(e){var t=ve.GetUrlComponents(e);if(ke.isAdfs(e))return e;var r=t.PathSegments;if(r&&r.length>=2){var n="tfp"===r[1]?2:1;n<r.length&&(r[n]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},it=function(e){return l.base64Encode(e)},at=function(e){return"msal."+(e||"")},st=function(){return!!("undefined"!==typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},ct=function(){function e(e,t,r){var n;this.eventId=l.createNewGuid(),this.label=r,this.event=((n={})[at(tt)]=e,n[at(rt)]=-1,n[""+nt.MsalCorrelationIdConstStrKey]=t,n)}return e.prototype.setElapsedTime=function(e){this.event[at(rt)]=e},e.prototype.stop=function(){var e,t,r;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,r=this.perfEndMark,st()&&(window.performance.mark(r),window.performance.measure(e,t,r),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(r))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[at("start_time")]=this.startTimestamp,e=this.perfStartMark,st()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+nt.MsalCorrelationIdConstStrKey]},set:function(e){this.event[""+nt.MsalCorrelationIdConstStrKey]=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[at(tt)]},enumerable:!1,configurable:!0}),e.prototype.get=function(){return i(i({},this.event),{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!1,configurable:!0}),e}(),ut=function(e){function t(t,r,n,o){var i=e.call(this,at("default_event"),r,"DefaultEvent")||this;return i.event[at("client_id")]=n,i.event[at("sdk_plaform")]=t.sdk,i.event[at("sdk_version")]=t.sdkVersion,i.event[at("application_name")]=t.applicationName,i.event[at("application_version")]=t.applicationVersion,i.event[at("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,i.event[""+nt.UiEventCountTelemetryBatchKey]=i.getEventCount(at("ui_event"),o),i.event[""+nt.HttpEventCountTelemetryBatchKey]=i.getEventCount(at("http_event"),o),i.event[""+nt.CacheEventCountConstStrKey]=i.getEventCount(at("cache_event"),o),i}return o(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(ct),lt=at("authority"),ht=at("authority_type"),dt=at("ui_behavior"),pt=at("tenant_id"),ft=at("user_id"),gt=at("was_successful"),mt=at("api_error_code"),yt=at("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(Ze||(Ze={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(et||(et={}));var vt=((Ye={})[et.AcquireTokenSilent]=Ze.AcquireTokenSilent,Ye[et.AcquireTokenPopup]=Ze.AcquireTokenPopup,Ye[et.AcquireTokenRedirect]=Ze.AcquireTokenRedirect,Ye[et.LoginPopup]=Ze.LoginPopup,Ye[et.LoginRedirect]=Ze.LoginRedirect,Ye[et.Logout]=Ze.Logout,Ye),bt=function(e){function t(t,r,n){var o=e.call(this,at("api_event"),t,n)||this;return n&&(o.apiCode=vt[n],o.apiEventIdentifier=n),o.piiEnabled=r,o}return o(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event[nt.ApiTelemIdConstStrKey]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event[nt.ApiIdConstStrKey]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[lt]=ot(e).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[mt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[pt]=this.piiEnabled&&e?it(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[ft]=this.piiEnabled&&e?it(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[gt]},set:function(e){this.event[gt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[yt]=this.piiEnabled&&e?it(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[ht]=e.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[dt]=e.toLowerCase()},enumerable:!1,configurable:!0}),t}(ct),It=at("http_path"),wt=at("user_agent"),Tt=at("query_parameters"),Et=at("api_version"),St=at("response_code"),Ct=at("oauth_error_code"),kt=at("http_method"),At=at("request_id_header"),Ot=at("spe_info"),Rt=at("server_error_code"),_t=at("server_sub_error_code"),Pt=at("url"),Nt=function(e){function t(t,r){return e.call(this,at("http_event"),t,r)||this}return o(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=ot(e);this.event[Pt]=t&&t.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[It]=ot(e).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[wt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[Tt]=Te.generateQueryParametersString(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[Et]=e.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[St]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[Ct]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[kt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[At]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[Ot]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[Rt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[_t]=e},enumerable:!1,configurable:!0}),t}(ct),Mt=function(){function e(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=i({sdk:h.libraryName,sdkVersion:we,networkInformation:{connectionSpeed:"undefined"!==typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},function(){},t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=c(t||[],[e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach(function(e){return t.incrementEventCount(e)});var n=c(this.completedEvents[e],r);delete this.completedEvents[e];var o=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],n&&n.length){var i=c(n,[new ut(this.telemetryPlatform,e,this.clientId,o)]);this.telemetryEmitter(i.map(function(e){return e.get()}))}}},e.prototype.createAndStartApiEvent=function(e,t){var r=new bt(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},e.prototype.stopAndFlushApiEvent=function(e,t,r,n){t.wasSuccessful=r,n&&(t.apiErrorCode=n),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,r,n){var o=new Nt(e,n);return o.url=r,o.httpMethod=t,this.startEvent(o),o},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(r,n){if(-1!==n.indexOf(e)){var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],c(r,[o])}return r},[])},e}(),xt=function(){function e(){}return e.filterTokenCacheItemsByScope=function(e,t){return e.filter(function(e){var r=e.key.scopes.split(" "),n=ye.removeDefaultScopes(t);return 0===n.length?ye.containsScope(r,t):ye.containsScope(r,n)})},e.filterTokenCacheItemsByAuthority=function(e,t){return e.filter(function(e){return ve.CanonicalizeUri(e.key.authority)===t})},e.filterTokenCacheItemsByDomain=function(e,t){return e.filter(function(e){return ve.GetUrlComponents(e.key.authority).HostNameAndPort===t})},e}(),Lt="https://login.microsoftonline.com/common",Ut=function(){function e(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=function(e){var t=e.auth,r=e.cache,n=void 0===r?{}:r,o=e.system,a=void 0===o?{}:o,s=e.framework,c=void 0===s?{}:s;return{auth:i(i({},He),t),cache:i(i({},Fe),n),system:i(i({},Ke),a),framework:i(i({},ze),c)}}(e),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),Se.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),qe.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||Lt,this.cacheStorage=new xe(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals||(window.activeRenewals={}),window.renewStates||(window.renewStates=[]),window.callbackMappedToRenewStates||(window.callbackMappedToRenewStates={}),window.promiseMappedToRenewStates||(window.promiseMappedToRenewStates={}),window.msal=this;var t=window.location.hash,r=ve.urlContainsHash(t);(Ue.checkIfBackButtonIsPressed(this.cacheStorage),r&&this.cacheStorage.isInteractionInProgress(!0))&&(this.getResponseState(t).method===h.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(t))}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=qe.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!1,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw me.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(h.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(h.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),ve.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,r){if(this.logger.verbose("AuthResponseHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===h.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==h.interactionTypePopup)throw $.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),r(t)}},e.prototype.authErrorHandler=function(e,t,r,n){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===h.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,r.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,r)}else{if(e!==h.interactionTypePopup)throw $.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),n(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=Me.validateRequest(e,!0,this.clientId,h.interactionTypeRedirect);this.acquireTokenInteractive(h.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=Me.validateRequest(e,!1,this.clientId,h.interactionTypeRedirect);this.acquireTokenInteractive(h.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var r=Me.validateRequest(e,!0,this.clientId,h.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,et.LoginPopup);return new Promise(function(e,n){t.acquireTokenInteractive(h.interactionTypePopup,!0,r,e,n)}).then(function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e})},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var r=Me.validateRequest(e,!1,this.clientId,h.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,et.AcquireTokenPopup);return new Promise(function(e,n){t.acquireTokenInteractive(h.interactionTypePopup,!1,r,e,n)}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e})},e.prototype.acquireTokenInteractive=function(e,t,r,n,o){var i,a=this;this.logger.verbose("AcquireTokenInteractive has been called"),Ue.blockReloadInHiddenIframes();try{this.cacheStorage.setInteractionInProgress(!0)}catch(l){var s=t?$.createLoginInProgressError():$.createAcquireTokenInProgressError(),c=Xe(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,s,c,o)}if(e===h.interactionTypeRedirect&&this.cacheStorage.setItem(p.REDIRECT_REQUEST,""+h.inProgress+h.resourceDelimiter+r.state),r&&r.account&&!t?(i=r.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),i||Te.isSSOParam(r))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(i,e,t,r,n,o);else{if(!t){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");c=Xe(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,$.createUserLoginRequiredError(),c,o)}if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var u=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(u).then(function(t){a.silentLogin=!1,a.logger.info("Unified cache call is successful"),a.authResponseHandler(e,t,n)},function(i){a.silentLogin=!1,a.logger.error("Error occurred during unified cache ATS: "+i),a.acquireTokenHelper(null,e,t,r,n,o)})}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,n,o)}},e.prototype.acquireTokenHelper=function(e,t,r,n,o,i){return a(this,void 0,void 0,function(){var a,c,u,l,d,f,y,v,b,I;return s(this,function(s){switch(s.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+r),a=n.scopes?n.scopes.join(" ").toLowerCase():h.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+a),u=n&&n.authority?qe.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance,s.label=1;case 1:return s.trys.push([1,11,,12]),u.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,qe.saveMetadataFromNetwork(u,this.telemetryManager,n.correlationId)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:if(d=r?m:this.getTokenType(e,n.scopes),f=n.redirectStartPage||window.location.href,c=new Te(u,this.clientId,d,this.getRedirectUri(n&&n.redirectUri),n.scopes,n.state,n.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(c,e,r,f),this.logger.verbose("Updating cache entries"),c.populateQueryParams(e,n),this.logger.verbose("Query parameters populated from account"),y=ve.createNavigateUrl(c)+h.response_mode_fragment,t===h.interactionTypeRedirect)r?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(xe.generateTemporaryCacheKey(p.STATE_ACQ_TOKEN,n.state),c.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+c.state));else{if(t!==h.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),$.createInvalidInteractionTypeError();window.renewStates.push(c.state),window.requestType=r?h.login:h.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+c.state),this.registerCallback(c.state,a,o,i)}if(t!==h.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{l=this.openPopup(y,"msal",h.popUpWidth,h.popUpHeight),Ue.trackPopup(l)}catch(w){if(this.logger.info(P.code+":"+P.desc),this.cacheStorage.setItem(g.ERROR,P.code),this.cacheStorage.setItem(g.ERROR_DESC,P.desc),i)return i($.createPopupWindowError()),[2]}if(!l)return[3,8];s.label=5;case 5:return s.trys.push([5,7,,8]),[4,Ue.monitorPopupForHash(l,this.config.system.loadFrameTimeout,y,this.logger)];case 6:return v=s.sent(),this.handleAuthenticationResponse(v),this.cacheStorage.setInteractionInProgress(!1),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",v),Ue.closePopups(),[3,8];case 7:return b=s.sent(),i&&i(b),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",b.errorCode+h.resourceDelimiter+b.errorMessage):(this.cacheStorage.setInteractionInProgress(!1),l.close()),[3,8];case 8:return[3,10];case 9:n.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==n.onRedirectNavigate(y)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(y)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(y)),s.label=10;case 10:return[3,12];case 11:return I=s.sent(),this.logger.error(I),this.cacheStorage.resetTempCacheItems(n.state),this.authErrorHandler(t,$.createEndpointResolutionError(I.toString),Xe(n.state),i),l&&l.close(),[3,12];case 12:return[2]}})})},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw me.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw me.createSsoSilentError();return this.acquireTokenSilent(i(i({},e),{scopes:h.oidcScopes}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var r=Me.validateRequest(e,!1,this.clientId,h.interactionTypeSilent),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,et.AcquireTokenSilent),o=Me.createRequestSignature(r);return new Promise(function(e,n){return a(t,void 0,void 0,function(){var t,i,a,c,u,l,d,p,f,g,m;return s(this,function(s){switch(s.label){case 0:if(Ue.blockReloadInHiddenIframes(),t=r.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),r.account?(i=r.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a=this.cacheStorage.getItem(h.adalIdToken),!i&&!r.sid&&!r.loginHint&&R.isEmpty(a))return this.logger.info("User login is required"),[2,n($.createUserLoginRequiredError())];if(c=this.getTokenType(i,r.scopes),this.logger.verbose("Response type: "+c),u=new Te(qe.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata),this.clientId,c,this.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),Te.isSSOParam(r)||i?(u.populateQueryParams(i,r,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):i||R.isEmpty(a)?this.logger.verbose("No additional query parameters added"):(l=Re.extractIdToken(a),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),u.populateQueryParams(i,null,l,!0)),!(d=r.claimsRequest||u.claimsValue)&&!r.forceRefresh)try{f=this.getCachedToken(u,i)}catch(y){p=y}return f?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(f.scopes)),e(f),[2,null]):[3,1];case 1:return p?(this.logger.infoPii(p.errorCode+":"+p.errorMessage),n(p),[2,null]):[3,2];case 2:g=void 0,g=d?"Skipped cache lookup since claims were given":r.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(g),u.authorityInstance||(u.authorityInstance=r.authority?qe.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+u.authority),s.label=3;case 3:return s.trys.push([3,7,,8]),u.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,qe.saveMetadataFromNetwork(u.authorityInstance,this.telemetryManager,r.correlationId)]);case 4:return s.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),s.label=6;case 6:return window.activeRenewals[o]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[o],o,e,n)):r.scopes&&ye.onlyContainsOidcScopes(r.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(o,e,n,i,u)):(this.logger.verbose("Renewing access token"),this.renewToken(o,e,n,i,u)),[3,8];case 7:return m=s.sent(),this.logger.error(m),n($.createEndpointResolutionError(m.toString())),[2,null];case 8:return[2]}})})}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e})},e.prototype.openPopup=function(e,t,r,n){this.logger.verbose("OpenPopup has been called");try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=a/2-r/2+o,u=s/2-n/2+i,l=window.open(e,t,"width="+r+", height="+n+", top="+u+", left="+c+", scrollbars=yes");if(!l)throw $.createPopupWindowError();return l.focus&&l.focus(),l}catch(h){throw this.cacheStorage.setInteractionInProgress(!1),$.createPopupWindowError(h.toString())}},e.prototype.loadIframeTimeout=function(e,t,r){return a(this,void 0,void 0,function(){var n,o,i,a,c;return s(this,function(s){switch(s.label){case 0:return n=window.activeRenewals[r],this.logger.verbosePii("Set loading state to pending for: "+r+":"+n),this.cacheStorage.setItem(xe.generateTemporaryCacheKey(p.RENEW_STATUS,n),h.inProgress),this.config.system.navigateFrameWait?[4,Ue.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return i=s.sent(),[3,3];case 2:i=Ue.loadFrameSync(e,t,this.logger),s.label=3;case 3:o=i,s.label=4;case 4:return s.trys.push([4,6,,7]),[4,Ue.monitorIframeForHash(o.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(a=s.sent())&&this.handleAuthenticationResponse(a),[3,7];case 6:throw c=s.sent(),this.cacheStorage.getItem(xe.generateTemporaryCacheKey(p.RENEW_STATUS,n))===h.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+n),n&&window.callbackMappedToRenewStates[n]&&window.callbackMappedToRenewStates[n](null,c),this.cacheStorage.removeItem(xe.generateTemporaryCacheKey(p.RENEW_STATUS,n))),Ue.removeHiddenIframe(o),c;case 7:return Ue.removeHiddenIframe(o),[2]}})})},e.prototype.navigateWindow=function(e,t){if(!e||R.isEmpty(e))throw this.logger.info("Navigate url is empty"),O.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){delete window.activeRenewals[t];for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw o.cacheStorage.resetTempCacheItems(e),O.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(a){o.logger.warning(a)}delete window.promiseMappedToRenewStates[e],delete window.callbackMappedToRenewStates[e]})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return a(this,void 0,void 0,function(){var t,r,n,o,i,a;return s(this,function(s){switch(s.label){case 0:t=e||l.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,et.Logout),this.clearCache(),this.account=null,s.label=1;case 1:return s.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,qe.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:return n="client-request-id="+t,o=void 0,this.getPostLogoutRedirectUri()?(o="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(o="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),i=void 0,this.authorityInstance.EndSessionEndpoint?(i=this.authorityInstance.EndSessionEndpoint+"?"+n+o,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(i=this.authority+"oauth2/v2.0/logout?"+n+o,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(i),[3,6];case 5:return a=s.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,a.errorCode),[3,6];case 6:return[2]}})})},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(h.clientId,h.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(h.clientId,h.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(n.key)),this.logger.verbosePii("Access token removed: "+n.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),ve.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,r){this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");var n,o,i=t;i||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),i=this.getResponseState(e));try{n=this.saveTokenFromHash(e,i)}catch(s){o=s}try{this.cacheStorage.clearMsalCookie(i.state);var a=this.getAccountState(i.state);if(n){if(i.requestType===h.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+u.ACCESS_TOKEN),n.tokenType=u.ACCESS_TOKEN):i.requestType===h.login&&(this.logger.verbose("Response tokenType set to "+u.ID_TOKEN),n.tokenType=u.ID_TOKEN),!r)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=n)}else if(!r)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=Xe(a),this.redirectError=o,void this.cacheStorage.resetTempCacheItems(i.state);this.logger.verbose("Calling callback provided to processCallback"),r(n,o)}catch(s){throw this.logger.error("Error occurred in token received callback function: "+s),$.createErrorInCallbackFunction(s.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,r=this.getResponseState(t);this.logger.verbose("Obtained state from response");var n=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,n)},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),Ue.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var r=this.cacheStorage.getItem(xe.generateTemporaryCacheKey(p.LOGIN_REQUEST,t.state),this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var n=ve.removeHashFromUrl(window.location.href),o=ve.removeHashFromUrl(r);if(n!==o)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+n+", finalRedirectUrl: "+o),void window.location.assign(""+o+e);this.logger.verbose("Current url matches login request url");var i=ve.GetUrlComponents(r);i.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=i.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,r=ve.deserializeHash(e);if(!r)throw O.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(u.STATE))throw O.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var n=Me.parseLibraryState(r.state);if((t={requestType:h.unknown,state:r.state,timestamp:n.ts,method:n.method,stateMatch:!1}).state===this.cacheStorage.getItem(xe.generateTemporaryCacheKey(p.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=h.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(xe.generateTemporaryCacheKey(p.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=h.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var o=window.renewStates,i=0;i<o.length;i++)if(o[i]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var r=e.scopes,n=this.getCachedIdToken(e,t),o=this.getCachedAccessToken(e,t,r),i=this.getAccountState(e.state);return je.buildAuthResponse(n,o,e,t,r,i)},e.prototype.getTokenCacheItemByAuthority=function(e,t,r,n){var o,i=this;return 1===(o=ve.isCommonAuthority(e)||ve.isOrganizationsAuthority(e)||ve.isConsumersAuthority(e)?xt.filterTokenCacheItemsByDomain(t,ve.GetUrlComponents(e).HostNameAndPort):xt.filterTokenCacheItemsByAuthority(t,e)).length?o[0]:o.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),o.forEach(function(e){i.cacheStorage.removeItem(JSON.stringify(e.key))}),null):(this.logger.verbose("No matching tokens of type "+n+" found"),null)},e.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var r=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),n=e.authority||this.authority,o=this.getTokenCacheItemByAuthority(n,r,null,u.ID_TOKEN);if(o){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(o)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var i=o.value;return i?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),i?new _e(i.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(o.key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getCachedAccessToken=function(e,t,r){this.logger.verbose("Getting all cached tokens of type Access Token");var n=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),o=xt.filterTokenCacheItemsByScope(n,r),i=e.authority||this.authority,a=this.getTokenCacheItemByAuthority(i,o,r,u.ACCESS_TOKEN);if(a){if(e.authorityInstance=qe.CreateInstance(a.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(a)){this.logger.verbose("Access token expiration is within offset, using access token found in cache");var s=t||this.getAccount();if(!s)throw O.createUnexpectedError("Account should not be null here.");var c=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:u.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:a.value.accessToken,scopes:a.key.scopes.split(" "),expiresOn:new Date(1e3*Number(a.value.expiresIn)),account:s,accountState:c,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(a.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},e.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return Re.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(h.adalIdToken);return R.isEmpty(e)?null:Re.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,n,o){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var i=Ue.generateFrameName(C,e);Ue.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbosePii("RenewToken expected state: "+o.state);var a=ve.urlRemoveQueryStringParameter(ve.createNavigateUrl(o),h.prompt)+h.prompt_none+h.response_mode_fragment;window.renewStates.push(o.state),window.requestType=h.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to: "+a),this.loadIframeTimeout(a,i,e).catch(function(e){return r(e)})},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("RenewIdToken has been called");var i=Ue.generateFrameName(S,e);Ue.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbose("RenewIdToken expected state: "+o.state);var a=ve.urlRemoveQueryStringParameter(ve.createNavigateUrl(o),h.prompt)+h.prompt_none+h.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=h.login,this.silentAuthenticationState=o.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=h.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,e,t,r),this.logger.infoPii('Navigate to:" '+a),this.loadIframeTimeout(a,i,e).catch(function(e){return r(e)})},e.prototype.saveToken=function(e,t,r,n,o){var i=new be(t,this.clientId,r,n.uid,n.utid),a=new Ie(e.accessToken,e.idToken.rawIdToken,o.toString(),n.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(i),JSON.stringify(a)),o?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*o)):this.logger.error("Could not parse expiresIn parameter for access token"),e},e.prototype.saveIdToken=function(e,t,r,n,o){this.logger.verbose("SaveIdToken has been called");var a=i({},e);a.scopes=h.oidcScopes,a.accessToken=r[u.ID_TOKEN];var s=Number(o.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(a,t,void 0,n,s)},e.prototype.saveAccessToken=function(e,t,r,n){this.logger.verbose("SaveAccessToken has been called");var o=i({},e),a=r[u.SCOPE],s=a.split(" "),c=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var l=0;l<c.length;l++){var h=c[l];if(h.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var d=h.key.scopes.split(" ");ye.isIntersectingScopes(d,s)&&this.cacheStorage.removeItem(JSON.stringify(h.key))}}o.accessToken=r[u.ACCESS_TOKEN],o.scopes=s;var p=Oe.parseExpiresIn(r[u.EXPIRES_IN]),f=Me.parseLibraryState(r[u.STATE]).ts+p;return this.logger.verbose("Saving access token to cache"),this.saveToken(o,t,a,n,f)},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},o=ve.deserializeHash(e),i="",a="",s=null;if(o.hasOwnProperty(u.ERROR_DESCRIPTION)||o.hasOwnProperty(u.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+o[u.ERROR]+"; Error description: "+o[u.ERROR_DESCRIPTION]),this.cacheStorage.setItem(g.ERROR,o[u.ERROR]),this.cacheStorage.setItem(g.ERROR_DESC,o[u.ERROR_DESCRIPTION]),t.requestType===h.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(g.LOGIN_ERROR,o[u.ERROR_DESCRIPTION]+":"+o[u.ERROR]),i=xe.generateAuthorityKey(t.state)),t.requestType===h.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),i=xe.generateAuthorityKey(t.state);var c=this.getAccount(),l=void 0;c&&!R.isEmpty(c.homeAccountIdentifier)?(l=c.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(l=h.no_account,this.logger.verbose("AccountId is set as no_account")),a=xe.generateAcquireTokenAccountKey(l,t.state)}var d=o[u.ERROR],m=o[u.ERROR_DESCRIPTION];r=$e.isInteractionRequiredError(d)||$e.isInteractionRequiredError(m)?new $e(o[u.ERROR],o[u.ERROR_DESCRIPTION]):new We(o[u.ERROR],o[u.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(u.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(xe.generateTemporaryCacheKey(p.SESSION_STATE,t.state),o[u.SESSION_STATE])),n.accountState=this.getAccountState(t.state);var y=void 0;if(o.hasOwnProperty(u.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),n.accessToken=o[u.ACCESS_TOKEN],o.hasOwnProperty(u.SCOPE)&&(n.scopes=o[u.SCOPE].split(" ")),o.hasOwnProperty(u.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),s=new _e(o[u.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),s=new _e(this.cacheStorage.getItem(f.IDTOKEN))),n=je.setResponseIdToken(n,s);var v=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s);this.logger.verbose("Got authority from cache"),o.hasOwnProperty(u.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),y=new Ae(o[u.CLIENT_INFO],v)):this.authorityInstance.AuthorityType===I.Adfs?y=Ae.createClientInfoFromIdToken(s,v):this.logger.warning("ClientInfo not received in the response from AAD"),n.account=Le.createAccount(s,y),this.logger.verbose("Account object created from response");var b=void 0;n.account&&!R.isEmpty(n.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),b=n.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),b=h.no_account),a=xe.generateAcquireTokenAccountKey(b,t.state);var w=xe.generateAcquireTokenAccountKey(h.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var T=this.cacheStorage.getItem(a),E=void 0;R.isEmpty(T)?R.isEmpty(this.cacheStorage.getItem(w))||(this.logger.verbose("No acquireToken account retrieved from cache"),n=this.saveAccessToken(n,v,o,y)):(E=JSON.parse(T),this.logger.verbose("AcquireToken request account retrieved from cache"),n.account&&E&&Le.compareAccounts(n.account,E)?(n=this.saveAccessToken(n,v,o,y),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(o.hasOwnProperty(u.ID_TOKEN)){this.logger.info("Fragment has idToken"),s=new _e(o[u.ID_TOKEN]);v=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s);if(n=je.setResponseIdToken(n,s),o.hasOwnProperty(u.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),y=new Ae(o[u.CLIENT_INFO],v)):this.authorityInstance.AuthorityType===I.Adfs?y=Ae.createClientInfoFromIdToken(s,v):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=Le.createAccount(s,y),n.account=this.account,this.logger.verbose("Account object created from response"),s&&s.nonce){this.logger.verbose("IdToken has nonce");var S=this.cacheStorage.getItem(xe.generateTemporaryCacheKey(p.NONCE_IDTOKEN,t.state),this.inCookie);s.nonce!==S?(this.account=null,this.cacheStorage.setItem(g.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+S+",Actual Nonce: "+s.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+S+", Actual Nonce: "+s.nonce),r=$.createNonceMismatchError(S,s.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(f.IDTOKEN,o[u.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(f.CLIENT_INFO,y.encodeClientInfo(),this.inCookie),this.saveIdToken(n,v,o,y,s))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),r=$.createInvalidIdTokenError(s),this.cacheStorage.setItem(g.ERROR,r.errorCode),this.cacheStorage.setItem(g.ERROR_DESC,r.errorMessage)}}else{this.logger.verbose("State mismatch"),i=t.state,a=t.state;var C=this.cacheStorage.getItem(xe.generateTemporaryCacheKey(p.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+C+", Actual State: "+t.state),r=$.createInvalidStateError(t.state,C),this.cacheStorage.setItem(g.ERROR,r.errorCode),this.cacheStorage.setItem(g.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(xe.generateTemporaryCacheKey(p.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!n)throw O.createUnexpectedError("Response is null");return n},e.prototype.populateAuthority=function(e,t,r,n){this.logger.verbose("PopulateAuthority has been called");var o=xe.generateAuthorityKey(e),i=r.getItem(o,t);return R.isEmpty(i)?i:ve.replaceTenantPath(i,n.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(f.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(f.CLIENT_INFO,this.inCookie);if(!R.isEmpty(e)&&!R.isEmpty(t)){var r=new _e(e),n=new Ae(t,"");return this.account=Le.createAccount(r,n),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(h.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(h.clientId,h.homeAccountIdentifier),r=0;r<t.length;r++){var n=new _e(t[r].value.idToken),o=new Ae(t[r].value.homeAccountIdentifier,""),i=Le.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:qe.CreateInstance(this.authority,this.config.auth.validateAuthority),a=this.getTokenType(o,e),s=new Te(i,this.clientId,a,this.getRedirectUri(),e,r,n);return this.getCachedToken(s,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?ve.getHostFromUri(e)===ve.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},e.prototype.setInteractionInProgress=function(e){this.cacheStorage.setInteractionInProgress(e)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"===typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"===typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw me.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t){var r=Le.compareAccounts(e,this.getAccount());return Te.determineResponseType(r,t)},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):h.no_account,n=xe.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=xe.generateAuthorityKey(e);this.cacheStorage.setItem(r,ve.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r,n){n&&this.cacheStorage.setItem(xe.generateTemporaryCacheKey(p.LOGIN_REQUEST,e.state),n,this.inCookie),r?this.cacheStorage.setItem(xe.generateTemporaryCacheKey(p.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(xe.generateTemporaryCacheKey(p.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return R.isEmpty(e.homeAccountIdentifier)?h.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:h.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return Mt.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw me.createTelemetryConfigError(e);return new Mt({platform:{applicationName:r,applicationVersion:n},clientId:t},o,this.logger)},e}();r.d(t,"UserAgentApplication",function(){return Ut}),r.d(t,"Logger",function(){return De}),r.d(t,"LogLevel",function(){return Ce}),r.d(t,"Account",function(){return Le}),r.d(t,"Constants",function(){return h}),r.d(t,"ServerHashParamKeys",function(){return u}),r.d(t,"Authority",function(){return ke}),r.d(t,"CryptoUtils",function(){return l}),r.d(t,"UrlUtils",function(){return ve}),r.d(t,"WindowUtils",function(){return Ue}),r.d(t,"AuthError",function(){return O}),r.d(t,"ClientAuthError",function(){return $}),r.d(t,"ServerError",function(){return We}),r.d(t,"ClientConfigurationError",function(){return me}),r.d(t,"InteractionRequiredAuthError",function(){return $e}),r.d(t,"version",function(){return we})}}]);
//# sourceMappingURL=26.1a7c017a.chunk.js.map